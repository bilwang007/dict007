# å¿«é€Ÿå¼€å§‹ - æ— æ•°æ®åº“ç‰ˆæœ¬

## ğŸ¯ è¿™ä¸ªç‰ˆæœ¬çš„ç‰¹ç‚¹

âœ… **ä¸éœ€è¦æ•°æ®åº“** - ä½¿ç”¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageï¼‰  
âœ… **ä¸éœ€è¦å­˜å‚¨æœåŠ¡** - ç›´æ¥ä½¿ç”¨AIç”Ÿæˆçš„å›¾ç‰‡URL  
âœ… **åªéœ€è¦OpenAI APIå¯†é’¥** - è¿™æ˜¯å”¯ä¸€éœ€è¦çš„å¤–éƒ¨æœåŠ¡  
âœ… **å®Œå…¨å…è´¹** - é™¤äº†OpenAI APIè´¹ç”¨ï¼ˆæ–°ç”¨æˆ·æœ‰$5å…è´¹é¢åº¦ï¼‰

---

## ğŸ“¦ é¡¹ç›®å·²ç»åŒ…å«çš„å†…å®¹

### å·²åˆ›å»ºçš„æ–‡ä»¶ï¼š

1. **`app/lib/storage.ts`** - æœ¬åœ°å­˜å‚¨å·¥å…·
   - ä¿å­˜/è¯»å–/åˆ é™¤ç¬”è®°æœ¬æ¡ç›®
   - ä½¿ç”¨æµè§ˆå™¨localStorage

2. **`app/lib/notebook-api.ts`** - å®¢æˆ·ç«¯ç¬”è®°æœ¬API
   - å°è£…äº†å­˜å‚¨æ“ä½œ
   - å¯ä»¥åœ¨ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨

3. **`app/notebook-simple/page.tsx`** - ç®€åŒ–ç‰ˆç¬”è®°æœ¬é¡µé¢
   - ä½¿ç”¨localStorageï¼Œä¸éœ€è¦æ•°æ®åº“
   - è®¿é—®åœ°å€ï¼š`/notebook-simple`

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨ï¼ˆ3ä¸ªæ­¥éª¤ï¼‰

### æ­¥éª¤1ï¼šè®¾ç½®ç¯å¢ƒå˜é‡

åˆ›å»ºæˆ–ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼š

```env
OPENAI_API_KEY=ä½ çš„OpenAIå¯†é’¥
```

**å¦‚ä½•è·å–å¯†é’¥ï¼š**
1. è®¿é—® https://platform.openai.com
2. æ³¨å†Œ/ç™»å½•
3. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ API Keys
4. åˆ›å»ºæ–°å¯†é’¥å¹¶å¤åˆ¶

### æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–

```bash
npm install
```

### æ­¥éª¤3ï¼šè¿è¡Œé¡¹ç›®

```bash
npm run dev
```

ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

---

## ğŸ”„ å¦‚ä½•åˆ‡æ¢åˆ°localStorageç‰ˆæœ¬

### æ–¹æ³•1ï¼šä½¿ç”¨ç®€åŒ–ç‰ˆç¬”è®°æœ¬é¡µé¢ï¼ˆæ¨èï¼‰

å¦‚æœä½ ç°åœ¨ä½¿ç”¨çš„æ˜¯æ•°æ®åº“ç‰ˆæœ¬ï¼Œä½†æƒ³è¯•è¯•localStorageç‰ˆæœ¬ï¼š

1. è®¿é—® `/notebook-simple` è€Œä¸æ˜¯ `/notebook`
2. è¿™ä¸ªé¡µé¢ä½¿ç”¨localStorageï¼Œä¸éœ€è¦æ•°æ®åº“

### æ–¹æ³•2ï¼šä¿®æ”¹ç°æœ‰ç»„ä»¶ä½¿ç”¨localStorage

å¦‚æœä½ æƒ³å®Œå…¨åˆ‡æ¢åˆ°localStorageç‰ˆæœ¬ï¼Œéœ€è¦ä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š

#### ä¿®æ”¹ `app/components/ResultCard.tsx`

å°†ä¿å­˜åŠŸèƒ½æ”¹ä¸ºä½¿ç”¨å®¢æˆ·ç«¯APIï¼š

```typescript
import { saveNotebookEntry } from '@/app/lib/notebook-api'

// åœ¨ä¿å­˜æŒ‰é’®çš„onClickä¸­ï¼š
const handleSave = async () => {
  setSaving(true)
  try {
    await saveNotebookEntry({
      word,
      targetLanguage,
      nativeLanguage,
      definition,
      imageUrl,
      exampleSentence1: examples[0]?.sentence || '',
      exampleSentence2: examples[1]?.sentence || '',
      exampleTranslation1: examples[0]?.translation || '',
      exampleTranslation2: examples[1]?.translation || '',
      usageNote,
    })
    setSaved(true)
  } catch (error) {
    console.error('ä¿å­˜å¤±è´¥:', error)
  } finally {
    setSaving(false)
  }
}
```

#### ä¿®æ”¹ `app/notebook/page.tsx`

å°†APIè°ƒç”¨æ”¹ä¸ºä½¿ç”¨å®¢æˆ·ç«¯APIï¼š

```typescript
import { fetchNotebookEntries, removeNotebookEntry } from '@/app/lib/notebook-api'

// æ›¿æ¢ fetchEntries å‡½æ•°ï¼š
const fetchEntries = async () => {
  setIsLoading(true)
  try {
    const data = await fetchNotebookEntries()
    setEntries(data)
  } catch (error) {
    console.error('åŠ è½½å¤±è´¥:', error)
  } finally {
    setIsLoading(false)
  }
}

// æ›¿æ¢ handleDelete å‡½æ•°ï¼š
const handleDelete = async (id: string) => {
  if (!confirm('ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ')) return
  setDeletingId(id)
  try {
    await removeNotebookEntry(id)
    await fetchEntries()
  } catch (error) {
    console.error('åˆ é™¤å¤±è´¥:', error)
  } finally {
    setDeletingId(null)
  }
}
```

---

## ğŸ“Š ä¸¤ç§ç‰ˆæœ¬å¯¹æ¯”

| åŠŸèƒ½ | æ•°æ®åº“ç‰ˆæœ¬ | localStorageç‰ˆæœ¬ |
|------|-----------|-----------------|
| éœ€è¦è®¾ç½® | PostgreSQLæ•°æ®åº“ | ä¸éœ€è¦ |
| æ•°æ®å­˜å‚¨ | æœåŠ¡å™¨æ•°æ®åº“ | æµè§ˆå™¨æœ¬åœ° |
| è·¨è®¾å¤‡åŒæ­¥ | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| æ•°æ®æŒä¹…æ€§ | âœ… æ°¸ä¹…ä¿å­˜ | âš ï¸ æ¸…é™¤æµè§ˆå™¨ä¼šä¸¢å¤± |
| è®¾ç½®éš¾åº¦ | ä¸­ç­‰ | éå¸¸ç®€å• |
| è´¹ç”¨ | å¯èƒ½éœ€è¦ä»˜è´¹æ•°æ®åº“ | å®Œå…¨å…è´¹ |

---

## ğŸ’¡ localStorageç‰ˆæœ¬çš„é™åˆ¶

### 1. æ•°æ®åªå­˜åœ¨å½“å‰æµè§ˆå™¨
- æ¢æµè§ˆå™¨ â†’ æ•°æ®ä¸å…±äº«
- æ¸…é™¤æµè§ˆå™¨æ•°æ® â†’ æ•°æ®ä¸¢å¤±
- æ¢è®¾å¤‡ â†’ æ•°æ®ä¸å…±äº«

### 2. å­˜å‚¨ç©ºé—´æœ‰é™
- é€šå¸¸é™åˆ¶ä¸º5-10MB
- å¤§çº¦å¯ä»¥å­˜å‚¨å‡ ç™¾ä¸ªå•è¯æ¡ç›®
- å¦‚æœæ»¡äº†ï¼Œéœ€è¦åˆ é™¤ä¸€äº›æ—§æ¡ç›®

### 3. å›¾ç‰‡URLå¯èƒ½å¤±æ•ˆ
- DALL-Eç”Ÿæˆçš„å›¾ç‰‡URLé€šå¸¸1å°æ—¶åå¤±æ•ˆ
- è§£å†³æ–¹æ¡ˆï¼š
  - ä½¿ç”¨Base64ä¿å­˜å›¾ç‰‡ï¼ˆè§storage.tsä¸­çš„`imageUrlToBase64`å‡½æ•°ï¼‰
  - æˆ–è€…æ¯æ¬¡éœ€è¦æ—¶é‡æ–°ç”Ÿæˆ

---

## ğŸ”§ å¦‚ä½•æ°¸ä¹…ä¿å­˜å›¾ç‰‡

å¦‚æœä½ æƒ³æ°¸ä¹…ä¿å­˜å›¾ç‰‡ï¼ˆé¿å…URLå¤±æ•ˆï¼‰ï¼Œå¯ä»¥ä½¿ç”¨Base64ï¼š

### åœ¨ä¿å­˜æ—¶è½¬æ¢å›¾ç‰‡ï¼š

```typescript
import { imageUrlToBase64, saveToNotebook } from '@/app/lib/storage'

// åœ¨ä¿å­˜å•è¯æ—¶ï¼š
const handleSave = async () => {
  try {
    let imageBase64 = undefined
    
    // å¦‚æœå›¾ç‰‡URLå­˜åœ¨ï¼Œè½¬æ¢ä¸ºBase64
    if (imageUrl) {
      try {
        imageBase64 = await imageUrlToBase64(imageUrl)
      } catch (error) {
        console.error('å›¾ç‰‡è½¬æ¢å¤±è´¥:', error)
        // ç»§ç»­ä¿å­˜ï¼Œåªæ˜¯æ²¡æœ‰Base64å›¾ç‰‡
      }
    }
    
    // ä¿å­˜åˆ°ç¬”è®°æœ¬
    await saveToNotebook({
      word,
      targetLanguage,
      nativeLanguage,
      definition,
      imageUrl, // ä¿ç•™åŸå§‹URLï¼ˆå¯èƒ½å¤±æ•ˆï¼‰
      imageBase64, // Base64ç‰ˆæœ¬ï¼ˆæ°¸ä¹…ä¿å­˜ï¼‰
      exampleSentence1: examples[0]?.sentence || '',
      exampleSentence2: examples[1]?.sentence || '',
      exampleTranslation1: examples[0]?.translation || '',
      exampleTranslation2: examples[1]?.translation || '',
      usageNote,
    })
  } catch (error) {
    console.error('ä¿å­˜å¤±è´¥:', error)
  }
}
```

### åœ¨æ˜¾ç¤ºæ—¶ä¼˜å…ˆä½¿ç”¨Base64ï¼š

```typescript
// åœ¨æ˜¾ç¤ºå›¾ç‰‡æ—¶ï¼š
{entry.imageBase64 ? (
  <img src={entry.imageBase64} alt={entry.word} />
) : entry.imageUrl ? (
  <img src={entry.imageUrl} alt={entry.word} />
) : null}
```

---

## ğŸ“ å­¦ä¹ å»ºè®®

### å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼š

1. **å…ˆä½¿ç”¨localStorageç‰ˆæœ¬**
   - æ›´ç®€å•ï¼Œä¸éœ€è¦è®¾ç½®æ•°æ®åº“
   - å¯ä»¥å¿«é€Ÿçœ‹åˆ°æ•ˆæœ
   - ç†è§£åŸºæœ¬åŠŸèƒ½å¦‚ä½•å·¥ä½œ

2. **ç†è§£åŸç†åå†å‡çº§**
   - ç­‰ç†Ÿæ‚‰äº†åŸºæœ¬åŠŸèƒ½
   - å†è€ƒè™‘ä½¿ç”¨æ•°æ®åº“ç‰ˆæœ¬
   - å­¦ä¹ å¦‚ä½•è®¾ç½®PostgreSQL

### å¦‚æœä½ æƒ³å­¦ä¹ æ•°æ®åº“ï¼š

1. **ä½¿ç”¨Supabaseï¼ˆæ¨èï¼‰**
   - å…è´¹é¢åº¦ï¼š500MBæ•°æ®åº“
   - è®¾ç½®ç®€å•ï¼Œæœ‰å›¾å½¢ç•Œé¢
   - è®¿é—®ï¼šhttps://supabase.com

2. **æŒ‰ç…§SETUP.mdè®¾ç½®**
   - é¡¹ç›®ä¸­çš„SETUP.mdæœ‰è¯¦ç»†è¯´æ˜
   - åŒ…æ‹¬Supabaseè®¾ç½®æ­¥éª¤

---

## â“ å¸¸è§é—®é¢˜

### Q: localStorageç‰ˆæœ¬çš„æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ
A: æ˜¯çš„ï¼Œå¦‚æœï¼š
- æ¸…é™¤æµè§ˆå™¨æ•°æ®
- ä½¿ç”¨éšç§æ¨¡å¼
- æµè§ˆå™¨å­˜å‚¨ç©ºé—´æ»¡äº†è¢«æ¸…ç†

### Q: å¯ä»¥åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªç‰ˆæœ¬å—ï¼Ÿ
A: å¯ä»¥ï¼ä½ å¯ä»¥ï¼š
- ä½¿ç”¨ `/notebook`ï¼ˆæ•°æ®åº“ç‰ˆæœ¬ï¼‰
- ä½¿ç”¨ `/notebook-simple`ï¼ˆlocalStorageç‰ˆæœ¬ï¼‰
- å®ƒä»¬çš„æ•°æ®æ˜¯åˆ†å¼€çš„

### Q: å¦‚ä½•å¤‡ä»½localStorageæ•°æ®ï¼Ÿ
A: å¯ä»¥å¯¼å‡ºä¸ºJSONï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
const data = localStorage.getItem('dictionary_notebook')
console.log(data) // å¤åˆ¶è¿™ä¸ªJSON
// æˆ–è€…ä¸‹è½½ä¸ºæ–‡ä»¶
const blob = new Blob([data], { type: 'application/json' })
const url = URL.createObjectURL(blob)
const a = document.createElement('a')
a.href = url
a.download = 'notebook-backup.json'
a.click()
```

### Q: å¦‚ä½•æ¢å¤æ•°æ®ï¼Ÿ
A: å°†å¤‡ä»½çš„JSONå¯¼å…¥ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
const jsonData = 'ä½ çš„JSONæ•°æ®'
localStorage.setItem('dictionary_notebook', jsonData)
// ç„¶ååˆ·æ–°é¡µé¢
```

---

## ğŸ‰ æ€»ç»“

localStorageç‰ˆæœ¬éå¸¸é€‚åˆï¼š
- âœ… å­¦ä¹ å’Œæµ‹è¯•
- âœ… ä¸ªäººä½¿ç”¨
- âœ… å¿«é€ŸåŸå‹
- âœ… ä¸éœ€è¦è·¨è®¾å¤‡åŒæ­¥çš„åœºæ™¯

å¦‚æœä½ éœ€è¦ï¼š
- è·¨è®¾å¤‡åŒæ­¥ â†’ ä½¿ç”¨æ•°æ®åº“ç‰ˆæœ¬
- å¤šäººä½¿ç”¨ â†’ ä½¿ç”¨æ•°æ®åº“ç‰ˆæœ¬
- æ°¸ä¹…ä¿å­˜ â†’ ä½¿ç”¨æ•°æ®åº“ç‰ˆæœ¬

**è®°ä½ï¼šå…ˆè®©åŸºæœ¬åŠŸèƒ½è·‘èµ·æ¥ï¼Œå†è€ƒè™‘å‡çº§ï¼** ğŸš€

